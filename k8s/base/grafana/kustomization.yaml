apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: grafana

# Grafana — VictoriaMetrics (PromQL互換) 可視化フロントエンド
resources:
  - configmap.yaml
  - deployment.yaml
  - service.yaml
  - pvc.yaml

configMapGenerator:
  - name: grafana-dashboards-provisioner
    files:
      - dashboards.yaml=dashboards/dashboards.yaml
    options:
      labels:
        app: grafana
        component: visualization
  - name: grafana-dashboard-device-overview
    files:
      - device-overview.json=dashboards/device-overview.json
    options:
      labels:
        app: grafana
        component: visualization
  - name: grafana-dashboard-room-overview
    files:
      - room-overview.json=dashboards/room-overview.json
    options:
      labels:
        app: grafana
        component: visualization
  - name: grafana-dashboard-gallery
    files:
      - gallery.json=dashboards/gallery.json
    options:
      labels:
        app: grafana
        component: visualization

labels:
  - includeSelectors: true
    pairs:
      app.kubernetes.io/name: grafana
      app.kubernetes.io/component: visualization
      app.kubernetes.io/part-of: smart-home-monitoring
